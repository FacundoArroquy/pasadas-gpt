<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
<title>Pasadas GPS (PWA)</title>

<!-- PWA basics -->
<link rel="manifest" href="manifest.webmanifest">
<meta name="theme-color" content="#89b7ac">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<link rel="apple-touch-icon" href="icons/apple-touch-icon.png">

<!-- Leaflet CSS -->
<link rel="preconnect" href="https://unpkg.com">
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
  integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin="anonymous">

<style>
  :root { --brand: #89b7ac; --accent: #0d6efd; }
  html, body { height: 100%; }
  body { font-family: -apple-system, system-ui, Segoe UI, Roboto, Arial, sans-serif; margin: 0; background: #ffffff; }
  header { position: sticky; top: 0; z-index: 5; background: var(--brand); color: #fff; padding: 12px 16px; }
  h1 { margin: 0; font-size: 1.25rem; }
  .wrap { padding: 12px 16px; }
  label { display:block; margin:6px 0 4px; font-size:.95rem; }
  input { padding:10px; border:1px solid #ddd; border-radius:10px; width:120px; }
  .row { display:flex; gap:12px; flex-wrap:wrap; align-items:flex-end; }
  button { padding:12px 16px; border:0; border-radius:12px; font-weight:600; }
  #startBtn { background: var(--accent); color:#fff; }
  #stopBtn { background:#6c757d; color:#fff; }
  #exportBtn, #installBtn { background:#f1f3f5; }
  #status { margin-top:8px; font-size:1rem; }
  .badge { display:inline-block; padding:4px 10px; border-radius:999px; color:#fff; font-size:.85rem; font-weight:700; }
  .work { background:#007bff; }
  .rest { background:#28a745; }
  .done { background:#6c757d; }
  #progress { margin-top:6px; display:flex; gap:12px; flex-wrap:wrap; }
  #map { height: 45vh; border-top:1px solid #eee; }
  #log { margin-top:12px; background:#fafafa; border-top:1px solid #eee; padding:10px; font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace; white-space:pre-wrap; max-height:20vh; overflow:auto; }
  .toolbar { display:flex; gap:8px; flex-wrap:wrap; margin-top:10px; }
  .tip { font-size:.9rem; color:#555; margin-top:6px; }
  .small { font-size:.85rem; color:#666; }
</style>
</head>
<body>
  <header>
    <h1>Pasadas GPS</h1>
    <div class="small">Web app instalable · funciona mejor al aire libre</div>
  </header>

  <div class="wrap">
    <div class="row">
      <div>
        <label>Repeticiones</label>
        <input id="reps" type="number" min="1" value="10">
      </div>
      <div>
        <label>Distancia trabajo (m)</label>
        <input id="workMeters" type="number" min="50" step="10" value="400">
      </div>
      <div>
        <label>Pausa (seg)</label>
        <input id="restSecs" type="number" min="10" step="5" value="60">
      </div>
    </div>

    <div class="toolbar">
      <button id="startBtn">Iniciar</button>
      <button id="stopBtn" disabled>Detener</button>
      <button id="exportBtn" disabled>Exportar GPX</button>
      <button id="installBtn" style="display:none">Instalar</button>
    </div>

    <div id="status"></div>
    <div id="progress"></div>
    <div class="tip">Consejo: mantené la pantalla activa. Si aparece el cuadro, aceptá “Mantener pantalla encendida”.</div>
  </div>

  <div id="map" role="region" aria-label="Mapa de la sesión"></div>

  <div class="wrap">
    <div id="log"></div>
    <div class="small">Mapas © OpenStreetMap contributors. Usá con moderación para respetar sus servidores.</div>
  </div>

  <!-- Leaflet JS -->
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
    integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin="anonymous"></script>

  <script src="main.js"></script>

  <script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => navigator.serviceWorker.register('sw.js'));
    }
  </script>
</body>
</html>
